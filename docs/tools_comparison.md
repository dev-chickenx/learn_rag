# Python環境管理ツール比較

Python開発における主要な環境管理ツール（pyenv, Poetry, uv）の違いと使い分けについて説明します。

## 各ツールの役割

| ツール | 主な役割 | 代替/類似ツール |
|--------|----------|----------------|
| **pyenv** | Pythonインタープリターのバージョン管理 | conda, asdf |
| **Poetry** | 依存関係管理・仮想環境管理・パッケージング | pip+venv+setuptools, pipenv, conda |
| **uv** | 高速パッケージインストール・軽量仮想環境 | pip, pip-tools |

## 詳細比較

### pyenv

**役割**: システムに複数のPythonバージョンをインストールし、プロジェクトやグローバル環境で使用するバージョンを切り替える

**主な機能**:

- 複数のPythonバージョンのインストールと切り替え
- プロジェクトごとのPythonバージョン指定（.python-version）
- Pythonのビルドオプションのカスタマイズ

**長所**:

- システムPythonに影響を与えずに複数バージョンを管理できる
- 簡単なコマンドでバージョン切り替えが可能
- プロジェクトディレクトリに入るだけで自動的に適切なバージョンが選択される

**短所**:

- 依存関係管理は行わない
- Windowsネイティブサポートがない（WSL推奨）
- ビルドに時間がかかることがある

### Poetry

**役割**: プロジェクトの依存関係管理、仮想環境の作成・管理、パッケージング

**主な機能**:

- プロジェクトの依存関係宣言と解決（pyproject.toml）
- ロックファイルによる厳密なバージョン管理（poetry.lock）
- 仮想環境の自動作成と管理
- パッケージのビルドと公開

**長所**:

- 依存関係の競合を検出・解決
- 開発用と本番用の依存関係を区別して管理
- プロジェクト情報とパッケージメタデータを一元管理
- 標準的なpyproject.tomlを使用（PEP 518準拠）

**短所**:

- 一部の複雑な依存関係解決に時間がかかることがある
- シンプルなスクリプト開発には機能過剰な場合も
- Pythonバージョン自体は管理しない（pyenvと併用が一般的）

### uv

**役割**: 高速なパッケージインストールと軽量な仮想環境管理

**主な機能**:

- パッケージのインストールを高速化（pipの代替）
- 軽量な仮想環境の作成と管理
- リソース使用量の最適化

**長所**:

- pipと比較して5〜30倍高速
- メモリ使用量の削減
- pip互換のコマンド体系
- Rustで実装されており安定性が高い

**短所**:

- 比較的新しいツールのため、一部のエッジケースで問題が生じる可能性
- 依存関係解決のロジックはPoetryほど高度ではない
- パッケージングや公開機能はない

## ツールの組み合わせ方

### 推奨組み合わせ: pyenv + Poetry + uv

1. **pyenv**: プロジェクトに適したPythonバージョンをインストール・管理
2. **Poetry**: プロジェクトの依存関係管理と仮想環境作成
3. **uv**: Poetry環境内でのパッケージインストール高速化

### 具体的なワークフロー例

```bash
# プロジェクトディレクトリ作成
mkdir my-project && cd my-project

# pyenvでPythonバージョン指定
pyenv local 3.11.9

# Poetryでプロジェクト初期化
poetry init

# 依存関係の追加
poetry add package1 package2

# 仮想環境の有効化
source $(poetry env info --path)/bin/activate

# uvを使用した高速パッケージ更新（Poetry環境内）
uv pip install -U pip setuptools
```

## どのような場合にどのツールを選ぶべきか

### pyenvを選ぶ場合

- 複数のPythonバージョンを使い分けたい
- システムPythonを変更せずに新しいバージョンを試したい
- プロジェクトごとに異なるPythonバージョンが必要

### Poetryを選ぶ場合

- 再現可能な開発環境が必要
- チームでの開発で環境を統一したい
- 依存関係の競合を自動的に解決したい
- PyPIにパッケージを公開する予定がある

### uvを選ぶ場合

- パッケージインストールの速度を重視する
- リソース使用量を最小限に抑えたい
- pipと互換性を保ちつつ高速化したい

### すべて組み合わせる場合

- 本格的なプロジェクト開発で最高の開発体験を得たい
- 複数のプロジェクトを維持し、それぞれが異なる要件を持つ
- 開発環境のセットアップ時間を最小化したい

## まとめ

- **pyenv**: Pythonバージョン自体の管理
- **Poetry**: プロジェクト依存関係とパッケージング
- **uv**: 高速なパッケージインストール

これらのツールはそれぞれ異なる問題を解決するために設計されていますが、組み合わせることで最適な開発環境を構築できます。プロジェクトの規模や要件に応じて、必要なツールを選択して使用することをお勧めします。
